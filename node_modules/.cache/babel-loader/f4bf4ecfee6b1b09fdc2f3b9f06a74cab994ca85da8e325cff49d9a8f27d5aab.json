{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\\\u5434\\u8BED\\u82E5\\\\Desktop\\\\\\u53EF\\u89C6\\u5316\\\\Project2\\\\src\\\\ScatterPlot.js\",\n  _s = $RefreshSig$();\n//创建散点图ScatterPlot组件\n\n//引入react、useRef和useEffect钩子、d3库\nimport React, { useRef, useEffect } from 'react';\nimport * as d3 from 'd3';\n\n// 定义React组件，接收data参数\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ScatterPlot = ({\n  data,\n  regionColors,\n  xAxis,\n  yAxis,\n  togglePoint,\n  Xmax,\n  Ymax\n}) => {\n  _s();\n  //创建一个名为ref的引用，引用SVG元素\n  const ref = useRef();\n\n  //处理组件的加载与更新\n  useEffect(() => {\n    // 选择当前元素\n    const svg = d3.select(ref.current);\n    //清空不需要的历史数据\n    svg.selectAll(\"*\").remove();\n    //获取SVG的宽和高\n    const width = +svg.attr(\"width\");\n    const height = +svg.attr(\"height\");\n\n    //利用线性比例尺创建坐标轴\n    const xScale = d3.scaleLinear().domain([0, 1.35 * Xmax]) //定义域为0到数据中x值的最大值的135%（使数据完全显示）\n    .range([0, width]); // 值域为0到SVG的宽度\n    // y轴的比例尺，定义域为0到数据中y值的最大值的120%，值域为SVG的高度到0\n    const yScale = d3.scaleLinear().domain([0, 1.2 * Ymax]).range([height, 0]);\n\n    //添加组元素g作为原点，并将其向右和向下移动30个单位使得坐标轴可以在svg中完整显示\n    const g = svg.append(\"g\").attr(\"transform\", \"translate(30, 0)\");\n\n    //散点标签\n    const tooltip = d3.select(\"body\").append(\"div\").style(\"position\", \"absolute\")\n    //初始时设置为隐藏\n    .style(\"visibility\", \"hidden\").style(\"background\", \"#f9f9f9\").style(\"border\", \"solid\").style(\"border-width\", \"1px\").style(\"border-radius\", \"5px\").style(\"padding\", \"10px\")\n    //标签文字可以换行\n    .style(\"white-space\", \"pre-wrap\");\n\n    //为每一个数据点添加一个圆形元素，位置由x和y的值决定，颜色由数据中的region值决定\n    g.selectAll(\"circle\").data(data) //绑定数据\n    .enter() //对于每一个数据元素，如果没有对应的圆形元素，就创建一个\n    //创建圆形元素\n    .append(\"circle\").attr(\"cx\", d => xScale(d.x)).attr(\"cy\", d => yScale(d.y)).attr(\"r\", d => d.isSelected ? 7 : 3).attr(\"fill\", d => d.isSelected ? '#DAA520' : regionColors[d.region]).attr(\"fill-opacity\", d => d.isSelected ? 1 : 0.7)\n\n    //鼠标互动事件\n    //当鼠标悬停在点上时，点的颜色变为亮黄色，并显示具体数值标签\n    .on(\"mouseover\", function (event, d) {\n      d3.select(this).attr(\"fill\", \"lightgoldenrodyellow\");\n      tooltip.html(`<strong>${d.country}</strong><br/>Region: ${d.region}<br/>${xAxis}: ${d.x}<br/>${yAxis}: ${d.y}`);\n      tooltip.style(\"visibility\", \"visible\");\n    })\n    //设置提示框的位置，跟随鼠标移动\n    .on(\"mousemove\", function (event) {\n      tooltip.style(\"top\", event.pageY - 10 + \"px\").style(\"left\", event.pageX + 10 + \"px\");\n    })\n\n    //当鼠标离开点时，点的颜色变回初始颜色，并隐藏标签\n    .on(\"mouseout\", function (d) {\n      d3.select(this).attr(\"fill\", d => regionColors[d.region]);\n      tooltip.style(\"visibility\", \"hidden\");\n    })\n    //当点被点击时，调用togglePoint函数跟踪点\n    .on('click', function (event, d) {\n      togglePoint(d.country);\n      tooltip.style(\"visibility\", \"hidden\");\n    });\n\n    //x轴标签\n    g.append(\"g\").attr(\"transform\", `translate(0, ${height - 60})`)\n    //创建x轴并把x轴添加到新的元素中\n    .call(d3.axisBottom(xScale))\n    //x轴的标签\n    .append(\"text\").attr(\"class\", \"x label\")\n    //文本以最后一个字符对齐\n    .attr(\"text-anchor\", \"end\").attr(\"x\", 0.9 * width).attr(\"y\", -6).style(\"fill\", \"black\").text(xAxis);\n\n    //y轴标签\n    g.append(\"g\").call(d3.axisLeft(yScale)).append(\"text\").attr(\"class\", \"y label\").attr(\"text-anchor\", \"end\").attr(\"y\", 6).attr(\"dy\", \".75em\")\n    //竖直显示\n    .attr(\"transform\", \"rotate(-90)\").style(\"fill\", \"black\").text(yAxis);\n  }, [data, xAxis, yAxis]);\n  //当data、xAxis、yAxis其中任何一个变化时，重新运行这个函数\n\n  // 返回一个SVG元素，使用ref引用，以便在effect中选择\n  return /*#__PURE__*/_jsxDEV(\"svg\", {\n    ref: ref,\n    width: \"300\",\n    height: \"300\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 114,\n    columnNumber: 10\n  }, this);\n};\n\n// 导出 ScatterPlot 组件\n_s(ScatterPlot, \"8uVE59eA/r6b92xF80p7sH8rXLk=\");\n_c = ScatterPlot;\nexport default ScatterPlot;\nvar _c;\n$RefreshReg$(_c, \"ScatterPlot\");","map":{"version":3,"names":["React","useRef","useEffect","d3","jsxDEV","_jsxDEV","ScatterPlot","data","regionColors","xAxis","yAxis","togglePoint","Xmax","Ymax","_s","ref","svg","select","current","selectAll","remove","width","attr","height","xScale","scaleLinear","domain","range","yScale","g","append","tooltip","style","enter","d","x","y","isSelected","region","on","event","html","country","pageY","pageX","call","axisBottom","text","axisLeft","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/吴语若/Desktop/可视化/Project2/src/ScatterPlot.js"],"sourcesContent":["//创建散点图ScatterPlot组件\r\n\r\n//引入react、useRef和useEffect钩子、d3库\r\nimport React, { useRef, useEffect } from 'react'; \r\nimport * as d3 from 'd3'; \r\n\r\n// 定义React组件，接收data参数\r\nconst ScatterPlot = ({ data, regionColors, xAxis, yAxis, togglePoint, Xmax, Ymax}) => {\r\n\r\n  //创建一个名为ref的引用，引用SVG元素\r\n  const ref = useRef(); \r\n\r\n  //处理组件的加载与更新\r\n  useEffect(() => {\r\n    \r\n    // 选择当前元素\r\n    const svg = d3.select(ref.current); \r\n    //清空不需要的历史数据\r\n    svg.selectAll(\"*\").remove();\r\n    //获取SVG的宽和高\r\n    const width = +svg.attr(\"width\");\r\n    const height = +svg.attr(\"height\");\r\n\r\n    //利用线性比例尺创建坐标轴\r\n    const xScale = d3.scaleLinear()\r\n      .domain([0, (1.35 * Xmax)])//定义域为0到数据中x值的最大值的135%（使数据完全显示）\r\n      .range([0, width]); // 值域为0到SVG的宽度\r\n    // y轴的比例尺，定义域为0到数据中y值的最大值的120%，值域为SVG的高度到0\r\n    const yScale = d3.scaleLinear().domain([0, 1.2 * Ymax]).range([height, 0]);\r\n\r\n    //添加组元素g作为原点，并将其向右和向下移动30个单位使得坐标轴可以在svg中完整显示\r\n    const g = svg.append(\"g\").attr(\"transform\", \"translate(30, 0)\");\r\n\r\n    //散点标签\r\n    const tooltip = d3.select(\"body\").append(\"div\")\r\n      .style(\"position\", \"absolute\")\r\n      //初始时设置为隐藏\r\n      .style(\"visibility\", \"hidden\")\r\n      .style(\"background\", \"#f9f9f9\")\r\n      .style(\"border\", \"solid\")\r\n      .style(\"border-width\", \"1px\")\r\n      .style(\"border-radius\", \"5px\")\r\n      .style(\"padding\", \"10px\")\r\n      //标签文字可以换行\r\n      .style(\"white-space\", \"pre-wrap\");\r\n\r\n    //为每一个数据点添加一个圆形元素，位置由x和y的值决定，颜色由数据中的region值决定\r\n    g.selectAll(\"circle\")\r\n      .data(data)//绑定数据\r\n      .enter()//对于每一个数据元素，如果没有对应的圆形元素，就创建一个\r\n      //创建圆形元素\r\n      .append(\"circle\")\r\n        .attr(\"cx\", d => xScale(d.x))\r\n        .attr(\"cy\", d => yScale(d.y))\r\n        .attr(\"r\", d => d.isSelected ? 7 : 3)\r\n        .attr(\"fill\", d => d.isSelected ? '#DAA520' : regionColors[d.region])\r\n        .attr(\"fill-opacity\", d => d.isSelected ? 1 : 0.7)\r\n        \r\n        //鼠标互动事件\r\n        //当鼠标悬停在点上时，点的颜色变为亮黄色，并显示具体数值标签\r\n        .on(\"mouseover\", function(event, d) {\r\n          d3.select(this).attr(\"fill\", \"lightgoldenrodyellow\");\r\n          tooltip.html(`<strong>${d.country}</strong><br/>Region: ${d.region}<br/>${xAxis}: ${d.x}<br/>${yAxis}: ${d.y}`);\r\n          tooltip.style(\"visibility\", \"visible\");\r\n        })\r\n        //设置提示框的位置，跟随鼠标移动\r\n        .on(\"mousemove\", function(event) {\r\n          tooltip.style(\"top\", (event.pageY - 10) + \"px\").style(\"left\", (event.pageX + 10) + \"px\");\r\n        })\r\n\r\n        //当鼠标离开点时，点的颜色变回初始颜色，并隐藏标签\r\n        .on(\"mouseout\", function(d) {\r\n            d3.select(this).attr(\"fill\", d => regionColors[d.region]);\r\n          tooltip.style(\"visibility\", \"hidden\");\r\n        })\r\n        //当点被点击时，调用togglePoint函数跟踪点\r\n        .on('click', function(event, d) {\r\n          togglePoint(d.country);\r\n          tooltip.style(\"visibility\", \"hidden\");\r\n        });\r\n\r\n    //x轴标签\r\n    g.append(\"g\")\r\n      .attr(\"transform\", `translate(0, ${height - 60})`)\r\n      //创建x轴并把x轴添加到新的元素中\r\n      .call(d3.axisBottom(xScale))\r\n      //x轴的标签\r\n      .append(\"text\")\r\n      .attr(\"class\", \"x label\")\r\n      //文本以最后一个字符对齐\r\n      .attr(\"text-anchor\", \"end\")\r\n      .attr(\"x\", 0.9 * width)\r\n      .attr(\"y\", -6)\r\n      .style(\"fill\", \"black\")\r\n      .text(xAxis);\r\n\r\n    //y轴标签\r\n    g.append(\"g\")\r\n      .call(d3.axisLeft(yScale))\r\n      .append(\"text\")\r\n      .attr(\"class\", \"y label\")\r\n      .attr(\"text-anchor\", \"end\")\r\n      .attr(\"y\", 6)\r\n      .attr(\"dy\", \".75em\")\r\n      //竖直显示\r\n      .attr(\"transform\", \"rotate(-90)\")\r\n      .style(\"fill\", \"black\")\r\n      .text(yAxis);\r\n      \r\n  }, [data, xAxis, yAxis]);\r\n  //当data、xAxis、yAxis其中任何一个变化时，重新运行这个函数\r\n\r\n  // 返回一个SVG元素，使用ref引用，以便在effect中选择\r\n  return <svg ref={ref} width=\"300\" height=\"300\"></svg>;\r\n};\r\n\r\n// 导出 ScatterPlot 组件\r\nexport default ScatterPlot;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}